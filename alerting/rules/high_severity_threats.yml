# ElastAlert rule for detecting high severity security threats

name: High Severity Security Threats
type: any
index: siem-logs-*

# Filter for high severity events
filter:
- terms:
    severity: ["HIGH", "CRITICAL"]
- terms:
    log_type: ["ids", "firewall"]

# Alert immediately on any high severity threat
realert:
  minutes: 30

# Alert content
alert:
- "email"
- "debug"

# Email configuration
smtp_host: localhost
smtp_port: 587
from_addr: siem-alerts@company.com
email:
- security-team@company.com
- soc-analyst@company.com

alert_text: |
  CRITICAL SECURITY ALERT: High Severity Threat Detected
  
  Alert ID: {0}
  Severity: {1}
  Message: {2}
  Source IP: {3}
  Destination IP: {4}
  Timestamp: {5}
  
  This is a high-priority security event that requires immediate attention.
  
  Event Details:
  - Log Type: {6}
  - Event Category: {7}
  - Source Location: {8}, {9}
  
  Please investigate immediately and take appropriate action.

alert_text_args:
- alert_id
- severity
- alert_msg
- src_ip
- dst_ip
- "@timestamp"
- log_type
- event_category
- src_geoip.city_name
- src_geoip.country_name

# Include all relevant fields
include:
- "@timestamp"
- alert_id
- severity
- alert_msg
- src_ip
- dst_ip
- src_port
- dst_port
- log_type
- event_category
- src_geoip
